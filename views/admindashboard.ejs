<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>

body {
            font-family: Arial, sans-serif;
            
          /*  background-image: url('/images/background.jpg');*/
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
       
    .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #f4f4f4;
    padding: 10px 20px;
    border-bottom: 1px solid #ccc;
    width: 100%;
   background-color: #333;
   /* color: rgb(23, 14, 92);*/
   color: rgb(251, 250, 254);
    padding: 10px 0;
    text-align: center;
}

.header h1 {
    margin: 0;
}
       
        .section {

            width: 40%;
           
            padding: 20px;
            border-radius: 10px;
            height: 100%;
            box-sizing: border-box;

        }
        .mainbar {

            width: 60%;
            height: 100%;
        }
       
        
    .button5 {
    background-color: #271719c4;
    border: none;
    color: white;
    padding: 50px 80px;
    text-align: center;
    text-decoration: none;
    font-size: 32px;
    margin: 4px 2px;
    cursor: pointer;
    display: inline-block;
    border-radius: 8px;
    transition: background-color 0.3s;
}


.button2 {
    background-color: #4c88adc7;
    border: none;
    color: white;
    padding: 50px 80px;
    text-align: center;
    text-decoration: none;
    font-size: 32px;
    margin: 4px 2px;
    cursor: pointer;
    display: inline-block;
    border-radius: 8px;
    transition: background-color 0.3s;
}

.button3 {
    background-color: #6c4cadb5;
    border: none;
    color: white;
    padding: 50px 80px;
    text-align: center;
    text-decoration: none;
    font-size: 32px;
    margin: 4px 2px;
    cursor: pointer;
    display: inline-block;
    border-radius: 8px;
    transition: background-color 0.3s;
}

.button4 {
    background-color: #ad664c;
    border: none;
    color: white;
    padding: 50px 80px;
    text-align: center;
    text-decoration: none;
    font-size: 32px;
    margin: 4px 2px;
    cursor: pointer;
    display: inline-block;
    border-radius: 8px;
    transition: background-color 0.3s;
}

.section {
  display: grid;
  justify-content: space-between;
  grid-template-columns: repeat(2, 1fr); 
  grid-gap: 10px; 
  width: fit-content; 
}
        .button2:hover {
            background-color: #45a04982;
        }
        
        .button3:hover {
            background-color: #45a04982;
        }

        .button4:hover {
            background-color: #45a04982;
        }
        .button5:hover {
            background-color: #45a04982;
        }
.section
{
    margin-top: 200px;
    
}


    .button1 {
    background-color: #4cad4f83;
    border: none;
    color: white;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    font-size: 16px;
    cursor: pointer;
    border-radius: 8px;
    transition: background-color 0.3s;
}
        .button1:hover {
            background-color: #45a049;
        }
        img{
            width:40px;
            height: 40px;
        }
        #papersContainer {
    display: flex;
    justify-content: center; /* Align items horizontally */
    flex-wrap: wrap; /* Allow items to wrap to the next line */
    margin-left: 20px; /* Adjust the left margin as needed */
}

.paper-image {
    width: 200px; /* Adjust the width to your desired size */
    height: auto; /* Maintain aspect ratio */
    margin: 10px; /* Add some margin for spacing */
}

    </style>
</head>
<body>
     <header class="header">
        <a href="/" class="button1">HOME</a>
        <h1>Welcome to the Admin Dashboard</h1>
        <a href="/admin/logout" class="button1" style="background-color: #ff4d4da7;">Logout</a>
     </header>

    <div class="section">
        
        <a href="/faculty_registration" class="button2">Faculty Registration</a>
        <a href="/faculty_actions" class="button3">Add/Edit Faculty Details</a>    
        <a href="/view_results" class="button4" data-toggle="modal" data-target="#ViewMarksModal">View Results</a>
        <button class="button5" data-toggle="modal" data-target="#addSubjectsModal">Add Subjects to Curriculum</button> <!-- New button -->
        
    </div>
    
    <div id="papersContainer" class="container mt-5">
        <!-- PDF links will be dynamically added here -->
    </div>


    <!-- View Marks Modal -->
<div class="modal fade" id="ViewMarksModal" tabindex="-1" role="dialog" aria-labelledby="ViewmarksModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ViewMarksModalLabel">View Marks</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- View Marks Form -->
                <form id="viewMarksForm" action="/view_marks" method="POST">
                    <div class="form-group">
                        <label for="yearv">Year:</label>
                        <select class="form-control" id="yearv" name="yearv" required>
                            <option value="">Select Year</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="semesterv">Semester:</label>
                        <select class="form-control" id="semesterv" name="semesterv" required>
                            <option value="">Select Semester</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="subjectv">Subject:</label>
                        <select class="form-control" id="subjectv" name="subjectv" required>
                            <option value="">Select Subject</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="midv">Mid:</label>
                        <select class="form-control" id="midv" name="midv" required>
                            <option value="">Select Mid</option>
                            <option value="1">Mid 1</option>
                            <option value="2">Mid 2</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>


        <!-- Bootstrap Modal -->
        <div class="modal fade" id="addSubjectsModal" tabindex="-1" role="dialog" aria-labelledby="addSubjectsModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addSubjectsModalLabel">Add Subjects to Curriculum</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form action="/add_subjects" method="POST">
                            <div class="form-group">
                                <label for="year">Year:</label>
                                <select id="year" name="year" class="form-control">
                                    <option value="1">1st Year</option>
                                    <option value="2">2nd Year</option>
                                    <option value="3">3rd Year</option>
                                    <option value="4">4th Year</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="semester">Semester:</label>
                                <select id="semester" name="semester" class="form-control">
                                    <option value="1">1st Semester</option>
                                    <option value="2">2nd Semester</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="subject1">Subject 1:</label>
                                <input type="text" class="form-control" id="subject1" name="subject1" value="">
                            </div>
                            <div class="form-group">
                                <label for="subject2">Subject 2:</label>
                                <input type="text" class="form-control" id="subject2" name="subject2" value="">
                            </div>
                            <div class="form-group">
                                <label for="subject3">Subject 3:</label>
                                <input type="text" class="form-control" id="subject3" name="subject3" value="">
                            </div>
                            <div class="form-group">
                                <label for="subject4">Subject 4:</label>
                                <input type="text" class="form-control" id="subject4" name="subject4" value="">
                            </div>
                            <div class="form-group">
                                <label for="subject5">Subject 5:</label>
                                <input type="text" class="form-control" id="subject5" name="subject5" value="">
                            </div>
                            <div class="form-group">
                                <label for="subject6">Subject 6:</label>
                                <input type="text" class="form-control" id="subject6" name="subject6" value="">
                            </div>
                            <button type="submit" class="btn btn-primary">Submit</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    
    <!-- Bootstrap Modal -->
    <div class="modal fade" id="viewPapersModal" tabindex="-1" role="dialog" aria-labelledby="viewPapersModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewPapersModalLabel">View Papers</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Folder Icon" class="img-fluid year-folder" data-year="1" data-toggle="modal" data-target="#semesterFoldersModal">
                            <p>Year 1</p>
                        </div>
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Folder Icon" class="img-fluid year-folder" data-year="2" data-toggle="modal" data-target="#semesterFoldersModal">
                            <p>Year 2</p>
                        </div>
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Folder Icon" class="img-fluid year-folder" data-year="3" data-toggle="modal" data-target="#semesterFoldersModal">
                            <p>Year 3</p>
                        </div>
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Folder Icon" class="img-fluid year-folder" data-year="4" data-toggle="modal" data-target="#semesterFoldersModal">
                            <p>Year 4</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="viewSelectedPapersModal" tabindex="-1" role="dialog" aria-labelledby="viewPapersModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewPapersModalLabel">View Papers</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Folder Icon" class="img-fluid year-folder" data-year="1" data-toggle="modal" data-target="#semesterFoldersModal">
                            <p>Year 1</p>
                        </div>
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Folder Icon" class="img-fluid year-folder" data-year="2" data-toggle="modal" data-target="#semesterFoldersModal">
                            <p>Year 2</p>
                        </div>
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Folder Icon" class="img-fluid year-folder" data-year="3" data-toggle="modal" data-target="#semesterFoldersModal">
                            <p>Year 3</p>
                        </div>
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Folder Icon" class="img-fluid year-folder" data-year="4" data-toggle="modal" data-target="#semesterFoldersModal">
                            <p>Year 4</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    
    <!-- Bootstrap Modal for Semester Folders -->
    <div class="modal fade" id="semesterFoldersModal" tabindex="-1" role="dialog" aria-labelledby="semesterFoldersModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="semesterFoldersModalLabel">Semester Folders</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Semester 1 Folder" class="img-fluid semester-folder" data-semester="1" data-toggle="modal" data-target="#midFoldersModal">
                            <p>Semester 1</p>
                        </div>
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Semester 2 Folder" class="img-fluid semester-folder" data-semester="2" data-toggle="modal" data-target="#midFoldersModal">
                            <p>Semester 2</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Modal for Mid Folders -->
    <div class="modal fade" id="midFoldersModal" tabindex="-1" role="dialog" aria-labelledby="midFoldersModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="midFoldersModalLabel">Mid Folders</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Mid 1 Folder" class="img-fluid mid-folder" data-mid="1" data-toggle="modal" data-target="#subjectFoldersModal">
                            <p>Mid 1</p>
                        </div>
                        <div class="col-md-3">
                            <img src="/images/folder.jpg" alt="Mid 2 Folder" class="img-fluid mid-folder" data-mid="2" data-toggle="modal" data-target="#subjectFoldersModal">
                            <p>Mid 2</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Modal for Subject Folders -->
    <div class="modal fade" id="subjectFoldersModal" tabindex="-1" role="dialog" aria-labelledby="subjectFoldersModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="subjectFoldersModalLabel">Subject Folders</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row" id="subjectFoldersContent">
                        <!-- Subject folders will be dynamically loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Your JavaScript logic -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function() {
            var selectedYear;
            var selectedSemester;
            var selectedMid;
            var selectedSubject;
        
            $('#viewPapersModal').on('show.bs.modal', function(event) {
                selectedYear = null;
                selectedSemester = null;
                selectedMid = null;
                console.log('Selected Year:', selectedYear);
                console.log('Selected Semester:', selectedSemester);
                console.log('Selected Mid:', selectedMid);
            });

            $('#viewSelectedPapersModal').on('show.bs.modal', function(event) {
                selectedYear = null;
                selectedSemester = null;
                selectedMid = null;
                console.log('Selected Year:', selectedYear);
                console.log('Selected Semester:', selectedSemester);
                console.log('Selected Mid:', selectedMid);
            });
        
            $('.year-folder').click(function() {
                selectedYear = $(this).data('year');
                console.log('Selected Year:', selectedYear);
            });
        
            $('.semester-folder').click(function() {
                selectedSemester = $(this).data('semester');
                console.log('Selected Semester:', selectedSemester);
            });
        
            $('.mid-folder').click(function() {
                selectedMid = $(this).data('mid');
                console.log('Selected Mid:', selectedMid);
                fetchSubjects(selectedYear, selectedSemester, selectedMid);
            });
        
            // Using event delegation for dynamically generated elements
            $(document).on('click', '.subject-folder', function() {
                selectedSubject = $(this).data('subject');
                console.log('Selected Subject:', selectedSubject);
                fetchQuestionPapers(selectedYear, selectedSemester, selectedMid, selectedSubject);
            });
        
            function fetchSubjects(year, semester, mid) {
                $.ajax({
                    url: '/fetch_subjects',
                    method: 'POST',
                    data: { year: year, semester: semester, mid: mid },
                    success: function(response) {
                        populateSubjectFolders(response);
                    },
                    error: function(xhr, status, error) {
                        console.error('Error fetching subjects:', error);
                    }
                });
            }
        
            function populateSubjectFolders(subjects) {
                var folderContent = $('#subjectFoldersContent');
                folderContent.empty();
                subjects.forEach(function(subject) {
                    var folderElement = $('<div class="col-md-3"><img src="/images/folder.jpg" alt="' + subject + ' Folder" class="img-fluid subject-folder" data-subject="' + subject + '"><p>' + subject + '</p></div>');
                    folderContent.append(folderElement);
                });
            }
        
            function fetchQuestionPapers(year, semester, mid, subject) {
    $.ajax({
        url: '/fetch_question_papers',
        method: 'POST',
        data: { year: year, semester: semester, mid: mid, subject: subject },
        success: function(response) {
            // Select the container element to append the URLs
            var container = $('#papersContainer');
            // Clear previous content
            container.empty();
            // Check if any papers are received
            if (response.length > 0) {
                console.log('Question paper URLs:');
                response.forEach(function(imageURL) {
                    // Remove 'admin/public' from the image URL
                    console.log(imageURL);
                    // Append the URL to the container
                    container.append('<a href="' + imageURL + '" target="_blank"><img src="' + imageURL + '" class="paper-image"></a><br>');
                });
            } else {
                container.append('<p>No question papers found.</p>');
                console.log('No question papers found.');
            }
            fetchHodSelected(year, semester, mid, subject, container); // Always fetch hod selected value
        },
        error: function(xhr, status, error) {
            console.error('Error fetching question papers:', error);
        }
    });
}

function fetchHodSelected(year, semester, mid, subject, container) { // Pass the container
    var hodSelectedColumn = 'hod_selected_' + mid;

    $.ajax({
        url: '/fetch_hod_selected',
        method: 'POST',
        data: { year: year, semester: semester, subject: subject },
        success: function(response) {
            
                // If "No question papers found" message exists, append hod_selected value below it
                container.append('<p>Question paper selected: ' + response.hodSelectedPaper + '</p>');
            
        },
        error: function(xhr, status, error) {
            console.error('Error fetching hod_selected value:', error);
        }
    });
}

        });
        </script>

<script>
    $(document).ready(function() {
        $('#yearv, #semesterv').change(function() {
            var year = $('#yearv').val();
            var semester = $('#semesterv').val();
            $.ajax({
                type: 'GET',
                url: '/get_subjects',
                data: {
                    year: year,
                    semester: semester
                },
                success: function(data) {
                    var subjectsDropdown = $('#subjectv');
                    subjectsDropdown.empty();
                    subjectsDropdown.append('<option value="">Select Subject</option>');
                    data.forEach(function(subject) {
                        subjectsDropdown.append('<option value="' + subject + '">' + subject + '</option>');
                    });
                },
                error: function(xhr, status, error) {
                    console.error(xhr.responseText);
                }
            });
        });
    });
</script>
        
    
    
</body>
</html>
